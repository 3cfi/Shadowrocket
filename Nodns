[General]
bypass-system = true
skip-proxy = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local, captive.apple.com
tun-excluded-routes = 10.0.0.0/8, 100.64.0.0/10, 127.0.0.0/8, 169.254.0.0/16, 172.16.0.0/12, 192.0.0.0/24, 192.0.2.0/24, 192.88.99.0/24, 192.168.0.0/16, 198.51.100.0/24, 203.0.113.0/24, 224.0.0.0/4, 255.255.255.255/32, 239.255.255.250/32
dns-server = 1.1.1.1, 8.8.8.8, 9.9.9.9, 1.0.0.1  # 使用Cloudflare和Google DNS
ipv6 = false
prefer-ipv6 = false
dns-fallback-system = false
dns-direct-system = false
icmp-auto-reply = true
always-reject-url-rewrite = false
private-ip-answer = true
dns-direct-fallback-proxy = true
proxy-method = "auto"

# DNS 配置
[DNS]
enable = true
prefer-h3 = true  # 优先使用DoH3协议
default-nameserver = ['https://1.12.12.12/dns-query', 'https://223.5.5.5/dns-query']  # 中国DNS解析
nameserver = ['https://doh.apad.pro/dns-query', 'https://1.0.0.1/dns-query', 'https://208.67.222.222/dns-query']  # 通用DNS解析
nameserver-policy = {
  '+.notion.com, +.notion.so, +.notion.site': 'tls://dns.jerryw.cn',  # Notion相关域名
  'geosite:geolocation-!cn': ['https://doh.apad.pro/dns-query', 'https://1.0.0.1/dns-query', 'https://208.67.222.222/dns-query'],  # 非中国区域流量
}

# GEO 数据加速配置
geodata-mode = true
geo-auto-update = true
geo-update-interval = 24
geodata-loader = 'standard'
geox-url = {
  geoip: 'https://fastgh.lainbo.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip-lite.dat',
  geosite: 'https://fastgh.lainbo.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat',
  mmdb: 'https://fastgh.lainbo.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country-lite.mmdb',
}

# 远程规则集（Rule-Set）
[Rule]
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Google/Google.list, 🦴Google
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/GoogleVoice/GoogleVoice.list, 🦴Google
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Speedtest/Speedtest.list, Speedtest
RULE-SET,https://raw.githubusercontent.com/dler-io/Rules/main/Surge/Surge%203/Provider/Scholar.list, 🎓Scholar
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Apple/Apple_All_No_Resolve.list, 🍎Apple
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Jetbrains/Jetbrains.list, 🎈Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Docker/Docker.list, 🎈Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Reddit/Reddit.list, 🎈Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Microsoft/Microsoft.list, 🪟Microsoft
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/PayPal/PayPal.list, 💳PayPal
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Netflix/Netflix.list, 📺Netflix
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Cloudflare/Cloudflare.list, 🎈Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/WeChat/WeChat.list, DIRECT
RULE-SET,https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Surge/OpenAI/OpenAI.list, 🍡OpenAI
RULE-SET,https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Surge/Telegram/Telegram.list, 💬Telegram
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/GitHub/GitHub.list, 🔨Dev
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Twitter/Twitter.list, 🐦Twitter
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Spotify/Spotify.list, 🎵Spotify
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/TikTok/TikTok.list, 🌻TikTok
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Facebook/Facebook.list, 🎈Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Whatsapp/Whatsapp.list, 🎈Proxy
RULE-SET,https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Surge/GoogleFCM/GoogleFCM.list, 🎈Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/YouTube/YouTube.list, 🎈Proxy
# DOMAIN-SUFFIX 规则
DOMAIN-SUFFIX,edu.cn, tailscale_3090_remote
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Proxy/Proxy.list, 🎈Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/AppleProxy/AppleProxy.list, 🎈Proxy
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/ChinaMedia/ChinaMedia.list, DIRECT
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/China/China.list, DIRECT
RULE-SET,https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/ruleset/ASN.China.list, DIRECT
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Lan/Lan.list, DIRECT
GEOIP,CN, DIRECT  # 中国大陆流量直连
FINAL, 🐟Final, dns-failed  # DNS查询失败处理

[Proxy Group]
# Define Proxy Group with Speed Test
best_proxy = url-test, ["http://www.gstatic.com/generate_204", "https://www.cloudflare.com"], 3  # 自动选择最快的代理

# Fallback Proxy Group - 自动切换代理
backup_proxy = fallback, [proxy1, proxy2], 5, 15  # 如果代理1响应慢于5ms，切换到代理2

# Load Balancing Proxy Group - 负载均衡
load_balanced_group = load-balance, [proxy1, proxy2, proxy3], 50  # 动态分配流量到多个代理节点

[Host]
localhost = 127.0.0.1

[URL Rewrite]
^https?://(www.)?g.cn https://www.google.com 302
^https?://(www.)?google.cn https://www.google.com 302
